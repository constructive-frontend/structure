"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var Struct=function(){function l(t,e,a,n,o,r,i){_classCallCheck(this,l),"object"!=_typeof(t)||t instanceof jQuery?(this.res=t,this.dom=e,null==n&&(n=function(){return!1}),this.events=n,"string"==typeof a?(this.data={},this.dataurl=a):(this.data=a,this.dataurl=o),this.data=a,this.dataurl=o,this.interval=r,this.dataloaded=!1,this.domloaded=!1,this.html="",this.errorevents=i):(this.res=t.el,this.dom=t.tmpl,null==t.events&&(t.events=function(){return!1}),this.events=t.events,"string"==typeof t.data?(this.data={},this.dataurl=t.data):(this.data=t.data,this.dataurl=t.dataurl),this.interval=t.interval,this.dataloaded=!1,this.domloaded=!1,this.html="",this.errorevents=t.errorevents),this.init()}return _createClass(l,[{key:"init",value:function(){var t=this;t.loadTmpl(),t.loadData(),null!=t.interval&&setInterval(function(){t.loadData(),t.render()},t.interval)}},{key:"render",value:function(){var t=this;if(t.res instanceof jQuery?t.el=t.res:t.el=$(t.res),t.dataloaded&&t.domloaded){if(Array.isArray(t.data))for(var e in t.el.html(""),t.data)t.el.append(t.setData(t.data[e],t.html));else t.el.html(t.setData(t.data,t.html));$(window).ready(function(){t.events()})}else setTimeout(function(){t.render()},100);return t}},{key:"rerender",value:function(){this.dataloaded=!1,this.domloaded=!1,this.loadTmpl(),this.loadData(),this.render()}},{key:"setData",value:function(t,e){for(var a in t)e=e.replace(new RegExp("{{"+a+"}}","g"),t[a]);return e}},{key:"loadTmpl",value:function(){var e=this;void 0!==e.dom?-1!==e.dom.indexOf("{{")||-1!==e.dom.indexOf("<")?(e.domloaded=!0,e.html=e.dom):e.getData("/"+e.dom+".html",function(t){e.html=t.responseText,e.domloaded=!0},function(){e.domloaded=!0,e.html=e.dom}):(e.domloaded=!0,e.html=e.dom)}},{key:"loadData",value:function(){var e=this;null!=this.dataurl?e.getData(this.dataurl,function(t){e.data=JSON.parse(t.responseText),e.dataloaded=!0},e.errorevents):e.dataloaded=!0}},{key:"getData",value:function(t,e,a){var n=new XMLHttpRequest;n.onreadystatechange=function(){n.readyState==XMLHttpRequest.DONE&&(200==n.status?e(n):null!=a&&a())},n.open("GET",t,!0),n.send()}}]),l}();