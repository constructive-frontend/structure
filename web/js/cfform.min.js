"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var Form=function(){function t(e){_classCallCheck(this,t),this.el=e,this.action="",this.method="GET","undefined"!==_typeof(this.el.attr("action"))&&!1!==this.el.attr("action")&&(this.action=this.el.attr("action")),"undefined"!==_typeof(this.el.attr("method"))&&!1!==this.el.attr("method")&&(this.method=this.el.attr("method")),this.init()}return _createClass(t,[{key:"init",value:function(){var t=this;t.el.bind("submit",function(){return t.send(),!1}),t.el.find(":input").bind("change, focusout",function(){var e=$(this);return t.send(e),!1})}},{key:"send",value:function(i){var r=this;$.ajax({url:r.action,type:r.method,dataType:"json",data:r.genData(),success:function(o,e,t){0<o.errors.length&&r.el.find(":input").each(function(e){var t=$(this),r=t.attr("name"),n=0;if(void 0===i||i.attr("name")==r){for(var s in o.errors){var a=o.errors[s];r==a.item&&(t.removeClass("success").addClass("error"),"LABEL"==t.prev().prop("tagName")&&t.prev().removeClass("success").addClass("error"),t.next().hasClass("errors")?t.next().html(a.msg):t.after("<div class='errors'>"+a.msg+"</div>"),n=1)}0==n&&(t.removeClass("error").addClass("success"),"LABEL"==t.prev().prop("tagName")&&t.prev().removeClass("error").addClass("success"),t.next().hasClass("errors")&&t.next().remove())}})}})}},{key:"genData",value:function(){var e={},t=this.el.serializeArray();for(var r in t){var n=t[r];e[n.name]=n.value}return JSON.stringify(e)}}]),t}();