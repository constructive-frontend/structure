"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var Form=function(){function t(e){_classCallCheck(this,t),this.el=e.el,this.data={},this.action="",this.method="GET","undefined"!==_typeof(this.el.attr("action"))&&!1!==this.el.attr("action")&&(this.action=this.el.attr("action")),"undefined"!==_typeof(this.el.attr("method"))&&!1!==this.el.attr("method")&&(this.method=this.el.attr("method")),this.event=e.event,this.init()}return _createClass(t,[{key:"init",value:function(){var t=this;t.el.bind("submit",function(){return t.send(),!1}),t.el.find(":input").bind("change, focusout",function(){var e=$(this);return t.send(e),!1})}},{key:"send",value:function(i){var e,r=this;e=void 0!==i?r.genData(1):r.genData(),$.ajax({url:r.action,type:r.method,dataType:"json",data:e,success:function(o,e,t){if(!(null!=o.errors&&0<o.errors.length))return r.el.find(":input").each(function(e){var t=$(this);t.attr("name");t.removeClass("error").addClass("success"),"LABEL"==t.prev().prop("tagName")&&t.prev().removeClass("error").addClass("success"),t.next().hasClass("errors")&&t.next().remove()}),r.data=o.data,r.event(),!1;r.el.find(":input").each(function(e){var t=$(this),r=t.attr("name"),a=0;if(void 0===i||i.attr("name")==r){for(var s in o.errors){var n=o.errors[s];r==n.item&&(t.removeClass("success").addClass("error"),"LABEL"==t.prev().prop("tagName")&&t.prev().removeClass("success").addClass("error"),t.next().hasClass("errors")?t.next().html(n.msg):t.after("<div class='errors'>"+n.msg+"</div>"),a=1)}0==a&&(t.removeClass("error").addClass("success"),"LABEL"==t.prev().prop("tagName")&&t.prev().removeClass("error").addClass("success"),t.next().hasClass("errors")&&t.next().remove())}})}})}},{key:"genData",value:function(e){var t={},r=this;if("GET"==r.method){var a=r.el.serialize();return void 0!==e&&1==e&&(a+="&isValidate=1"),a}var s=r.el.serializeArray();for(var n in s){var o=s[n];t[o.name]=o.value}return console.log("isValidate = "+e),void 0!==e&&1==e&&(t.isValidate=1),JSON.stringify(t)}}]),t}();